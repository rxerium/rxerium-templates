id: CVE-2025-46343

info:
  name: CVE-2025-46343 - n8n Workflow Automation - Cross-Site Scripting
  author: rxerium
  severity: medium
  description: |
    n8n prior to version 1.90.0 contains a stored cross-site scripting caused by uploading crafted HTML files with controllable MIME types, letting authenticated attackers execute malicious scripts in other users' browsers, exploit requires uploading malicious files and setting MIME type via GET parameter.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-46343
    - https://github.com/n8n-io/n8n/pull/14350
    - https://github.com/n8n-io/n8n/pull/14685
    - https://github.com/n8n-io/n8n/releases/tag/n8n%401.90.0
    - https://github.com/n8n-io/n8n/security/advisories/GHSA-c8hm-hr8h-5xjw
  metadata:
    vendor: n8n
    product: n8n Workflow Automation
    cvss-score: 5.0
    cwe-id: CWE-79
    verified: true
    shodan-query: http.favicon.hash:-831756631
  tags: cve,cve2025,n8n,workflow

http:
  - method: GET
    path:
      - "{{BaseURL}}/signin"

    extractors:
      - type: regex
        name: base64_content
        group: 1
        regex:
          - '<meta name="n8n:config:sentry" content="([A-Za-z0-9+/=]+)"'
        internal: true

      - type: dsl
        name: decoded
        dsl:
          - 'base64_decode(base64_content)'
        internal: true

      - type: dsl
        name: version
        dsl:
          - 'replace_regex(decoded, ".*n8n@([0-9]+\\.[0-9]+\\.[0-9]+).*", "$1")'
        internal: true

      - type: dsl
        dsl:
          - '"n8n Version: " + version'

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "<title>n8n.io"
        case-insensitive: true

      - type: status
        status:
          - 200

      - type: dsl
        name: vulnerable
        dsl:
          - 'compare_versions(version, "== 1.90.0")'
