id: CVE-2025-34299

info:
  name: CVE-2025-34299 - Monsta FTP Unauthenticated Arbitrary File Upload RCE
  author: rxerium
  severity: critical
  description: |
    Monsta FTP versions 2.11 and earlier contain a critical unauthenticated arbitrary file upload vulnerability in the API endpoint /mftp/application/api/api.php. The application accepts user-supplied file paths through the localPath parameter without adequate validation, allowing attackers to manipulate input and write files to arbitrary locations on the web server. This flaw enables remote code execution without authentication or prior access. The vulnerability has been actively exploited in the wild since its disclosure. Patches released in version 2.11.3 on August 26, 2025.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-34299
    - https://labs.watchtowr.com/whats-that-coming-over-the-hill-monsta-ftp-remote-code-execution-cve-2025-34299/
    - https://github.com/advisories/GHSA-42m5-3r2p-wr92
    - https://www.vulncheck.com/advisories/monsta-ftp-unauthenticated-arbitrary-file-upload
  metadata:
    vendor: Monsta
    product: Monsta FTP
    cvss-score: 9.3
    cwe-id: CWE-434
    cisa-kev: false
    verified: true
    shodan-query: http.title:"Monsta FTP"
  tags: cve,cve2025,monsta,ftp,file-upload,rce,zero-day

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    extractors:
      - type: regex
        name: version
        group: 1
        regex:
          - '<title>Monsta FTP v([0-9.]+)'

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "<title>Monsta FTP"

      - type: status
        status:
          - 200

      - type: dsl
        dsl:
          - compare_versions(version, "< 2.11")
