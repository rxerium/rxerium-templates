id: CVE-2025-37164

info:
  name: CVE-2025-37164 - HPE OneView Unauthenticated Remote Code Execution
  author: rxerium
  severity: critical
  description: |
    CVE-2025-37164 is a critical unauthenticated remote code execution vulnerability in HPE OneView with a maximum CVSS score of 10.0. The vulnerability stems from improper control of code generation (CWE-94), allowing unauthenticated threat actors to exploit the flaw via low-complexity code injection attacks over the network. No privileges or user interaction are required for exploitation, and successful attacks can grant total control over data centres. The vulnerability affects all HPE OneView versions released before v11.00 (specifically versions 5.20 through 10.20). HPE has released version 11.00 and security hotfixes for affected versions to address this critical flaw.

    How does this detection method work? This template matches on the OneView title tag, extracts the version from the JavaScript artifactVersion variable, and flags instances running versions below 11.00 as potentially vulnerable. Note that instances flagged by this template are possibly vulnerable as the detection method cannot determine whether the Z7550-98077 security hotfix has been applied to versions 5.20-10.20 - only upgrading to version 11.00+ can be reliably verified as patched.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-37164
    - https://support.hpe.com/hpesc/public/docDisplay?docId=a00117617en_us&docLocale=en_US
    - https://www.bleepingcomputer.com/news/security/hpe-warns-of-maximum-severity-rce-flaw-in-oneview-software/
    - https://securityonline.info/cve-2025-37164-cvss-10-0-unauthenticated-hpe-oneview-rce-grants-total-control-over-data-centers/
    - https://ccb.belgium.be/advisories/warning-critical-rce-vulnerability-identified-hpe-oneview-patch-immediately
  metadata:
    max-request: 1
    vendor: hpe
    product: oneview
    cvss-score: 10.0
    cwe-id: CWE-94
    verified: true
    shodan-query: http.favicon.hash:-1569311459
  tags: cve,cve2025,hpe,oneview,rce,code-injection,critical

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - 'var artifactVersion = "([0-9]+\.[0-9]+\.[0-9]+)"'
        internal: true

      - type: kval
        kval:
          - version

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: body
        words:
          - "<title>OneView"

      - type: dsl
        dsl:
          - "compare_versions(version, '<11.00')"
