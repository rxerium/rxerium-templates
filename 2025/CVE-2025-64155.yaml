id: CVE-2025-64155

info:
  name: CVE-2025-64155 - Fortinet FortiSIEM OS Command Injection RCE
  author: rxerium
  severity: critical
  description: |
    Fortinet FortiSIEM versions 6.7.0 through 7.4.0 contain a critical OS command injection vulnerability resulting from improper neutralization of special elements used in operating system commands. Unauthenticated attackers can exploit this vulnerability by sending specially crafted TCP requests, potentially leading to unauthorized code execution on the affected system. The vulnerability has a CVSS v3.1 base score of 9.8. Patched versions include FortiSIEM 7.4.1, 7.3.5, and 7.2.7.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-64155
    - https://fortiguard.fortinet.com/psirt/FG-IR-25-772
  metadata:
    verified: true
    max-request: 1
    vendor: fortinet
    product: fortisiem
    cvss-score: 9.4
    cwe-id: CWE-78
    shodan-query:
      - http.favicon.hash:-1341442175
      - http.html:"var hst = location.hostname"
    fofa-query:
      - icon_hash="-1341442175"
      - body="var hst = location.hostname"
  tags: cve,cve2025,fortinet,fortisiem,os-command-injection,rce

http:
  - method: GET
    path:
      - "{{BaseURL}}/phoenix/login.html"

    extractors:
      - type: dsl
        name: last_modified_date
        dsl:
          - last_modified

      - type: dsl
        name: date_unix
        internal: true
        dsl:
          - 'to_unix_time(last_modified, "Mon, 02 Jan 2006 15:04:05 MST")'

      - type: kval
        part: header
        kval:
          - last_modified

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - 'id="loginUserNameInput"'
          - 'id="loginPwdInput"'
          - 'id="loginOrgInput"'
        condition: and

      - type: word
        part: body
        words:
          - 'id="loginDomainSelector"'
          - 'id="loginDomainInput"'
        condition: and

      - type: status
        status:
          - 200

      - type: dsl
        dsl:
          - compare_versions(date_unix, "< 1768262400")
