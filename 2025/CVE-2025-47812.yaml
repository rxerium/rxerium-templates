id: CVE-2025-47812

info:
  name: CVE-2025-47812 - Wing FTP Server Null Byte Injection Remote Code Execution
  author: rxerium
  severity: critical
  description: |
    Wing FTP Server versions prior to 7.4.4 contain a critical null byte injection vulnerability in the user and admin web interfaces. Improper handling of '\0' bytes allows injection of arbitrary Lua code into user session files, enabling execution of arbitrary system commands with root or SYSTEM privileges. The vulnerability can be exploited via anonymous FTP accounts, requiring no authentication. Active exploitation has been observed since July 1, 2025, with threat actors using it to download malicious Lua files, conduct reconnaissance, create persistence through new users, and install ScreenConnect remote access tools. CISA added this to the KEV catalogue on July 14, 2025.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-47812
    - https://thehackernews.com/2025/07/critical-wing-ftp-server-vulnerability.html
    - https://www.huntress.com/blog/wing-ftp-server-remote-code-execution-cve-2025-47812-exploited-in-wild
    - https://arcticwolf.com/resources/blog/cve-2025-47812/
  metadata:
    vendor: Wing FTP Software
    product: Wing FTP Server
    cvss-score: 10.0
    cwe-id: CWE-158
    cisa-kev: true
    verified: true
  tags: cve,cve2025,kev,wingftp,null-byte,rce

http:
  - method: GET
    path:
      - "{{BaseURL}}/login.html?lang=english"


    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - 'Wing FTP Server v([0-9.]+)'

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: body
        words:
          - "Wing FTP Server"

      - type: dsl
        dsl:
          - compare_versions(version, "< 7.4.4")
