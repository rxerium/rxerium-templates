id: CVE-2025-58360

info:
  name: CVE-2025-58360 - GeoServer WMS GetMap Unauthenticated XXE
  author: rxerium
  severity: critical
  description: |
    GeoServer versions prior to 2.25.6, 2.26.0-2.26.1 contain a critical unauthenticated XML External Entity (XXE) vulnerability in the WMS GetMap operation endpoint. The application accepts XML input without proper validation of external entities, allowing attackers to access arbitrary files from the server's file system, conduct Server-Side Request Forgery attacks against internal systems, or launch denial-of-service attacks through resource exhaustion. This vulnerability has been actively exploited in the wild as confirmed by the Canadian Centre for Cyber Security. CISA added it to the KEV catalogue on December 11, 2025, mandating federal agencies to patch by January 1, 2026. Discovered by XBOW AI-powered vulnerability platform.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-58360
    - https://thehackernews.com/2025/12/cisa-flags-actively-exploited-geoserver.html
    - https://www.cisa.gov/known-exploited-vulnerabilities-catalog
    - https://www.securityweek.com/recent-geoserver-vulnerability-exploited-in-attacks/
  metadata:
    max-request: 2
    vendor: OSGeo
    product: GeoServer
    cvss-score: 9.8
    cwe-id: CWE-611
    cisa-kev: true
    verified: true
    shodan-query:
      - 'http.title:"GeoServer: Redirecting"'
      - 'http.html_hash:1093634893 "Content-Disposition: inline"'
  tags: cve,cve2025,kev,geoserver,xxe,ssrf

http:
  - method: GET
    path:
      - "{{BaseURL}}/geoserver/web/wicket/resource/org.geoserver.web.GeoServerBasePage/img/logo.png"
      - "{{BaseURL}}/web/wicket/resource/org.geoserver.web.GeoServerBasePage/img/logo.png"

    extractors:      
      - type: kval
        name: date
        part: header
        kval:
          - last_modified

      - type: dsl
        name: last_modified_ts
        dsl:
          - to_unix_time(date, "Mon, 02 Jan 2006 15:04:05 MST")
        internal: true

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: dsl
        dsl:
          - sha256(body)=="24738974cad3b3887d11c118248e625da82ca89c8fd21f5bc978d6a29888ebb6"

      - type: dsl
        dsl:
          - compare_versions(last_modified_ts, "< 1732752000")
