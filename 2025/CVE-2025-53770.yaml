id: CVE-2025-53770

info:
  name: CVE-2025-53770 - Microsoft SharePoint Server Deserialization RCE
  author: rxerium
  severity: critical
  description: |
    Microsoft SharePoint Server (on-premises) 2016, 2019, and Subscription Edition contain a critical unauthenticated deserialization vulnerability that allows remote code execution. The flaw stems from unsafe deserialization of untrusted data, enabling unauthorized attackers to execute code over a network without authentication. This vulnerability is a patch bypass for CVE-2025-49704 and part of the "ToolShell" vulnerability chain. Active zero-day exploitation has been observed since July 17, 2025, by threat actor CL-CRI-1040. CISA added this to the Known Exploited Vulnerabilities catalogue on July 20, 2025. SharePoint Online is not affected.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-53770
    - https://www.microsoft.com/en-us/msrc/blog/2025/07/customer-guidance-for-sharepoint-vulnerability-cve-2025-53770
    - https://www.cisa.gov/news-events/alerts/2025/07/20/microsoft-releases-guidance-exploitation-sharepoint-vulnerability-cve-2025-53770
    - https://unit42.paloaltonetworks.com/microsoft-sharepoint-cve-2025-49704-cve-2025-49706-cve-2025-53770/
  metadata:
    vendor: Microsoft
    product: SharePoint Server
    cvss-score: 9.8
    cwe-id: CWE-502
    cisa-kev: true
    verified: true
    shodan-query:
      - http.favicon.hash:-19436759
      - http.favicon.hash:-146638980
      - http.favicon.hash:-1969918997
  tags: cve,cve2025,kev,microsoft,sharepoint,deserialization,rce,zero-day

http:
  - method: GET
    path:
      - "{{BaseURL}}/_layouts/15/error.aspx"

    extractors:
      - type: regex
        name: build
        group: 1
        regex:
          - '"?siteClientTag"?\s*:\s*"\d*[$]+([^"]+)"'

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: body
        words:
          - 'content="Microsoft SharePoint"'

      - type: dsl
        dsl:
          # If it's Subscription Edition (>=16.0.14326), check against SE patched build
          - (compare_versions(build, ">=16.0.14326.20450") && compare_versions(build, "<16.0.18526.20508"))
          # If it's SharePoint 2019 (>=16.0.10337 && <16.0.14326), check against 2019 patched build
          - (compare_versions(build, ">=16.0.10337.12109") && compare_versions(build, "<16.0.10417.20037"))
          # If it's SharePoint 2016 (>=16.0.4336 && <16.0.10337), check against 2016 patched build
          - (compare_versions(build, ">=16.0.4336.1000") && compare_versions(build, "<16.0.5513.1001"))
        condition: or
