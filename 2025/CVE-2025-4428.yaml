id: CVE-2025-4428

info:
  name: CVE-2025-4428 - Ivanti EPMM Code Injection Remote Code Execution
  author: rxerium
  severity: critical
  description: |
    Ivanti Endpoint Manager Mobile (EPMM) version 12.5.0.0 and prior contains a critical code injection vulnerability in the API component. The flaw stems from insufficient validation of inputs passed to execution functions, failing to properly sanitize user inputs. Authenticated attackers can execute arbitrary code via crafted API requests. This vulnerability is actively exploited in the wild, chained with CVE-2025-4427 authentication bypass to achieve unauthenticated remote code execution. CISA has added this to the Known Exploited Vulnerabilities catalogue. Threat actors deploy malicious listeners as backdoors on compromised systems.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-4428
    - https://www.cisa.gov/known-exploited-vulnerabilities-catalog
    - https://labs.watchtowr.com/expression-payloads-meet-mayhem-cve-2025-4427-and-cve-2025-4428/
    - https://socprime.com/blog/detect-cve-2025-4427-and-cve-2025-4428-exploitation/
    - https://www.picussecurity.com/resource/blog/malicious-listeners-ivanti-epmm-cve-2025-4427-cve-2025-4428-backdoors
  metadata:
    vendor: Ivanti
    product: Endpoint Manager Mobile
    cvss-score: 8.8
    cwe-id: CWE-94
    cisa-kev: true
    verified: true
    shodan-query: product:"Ivanti Endpoint Manager Mobile (EPMM)"
  tags: cve,cve2025,kev,ivanti,code-injection,rce

http:
  - method: GET
    path:
      - "{{BaseURL}}/mics/login.jsp"

    extractors:
      - type: regex
        name: version
        group: 1
        regex:
          - '<div[^>]*class="[^"]*product-version[^"]*"[^>]*>\s*([0-9.]+)\s*</div>'

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "Ivanti System Manager"

      - type: status
        status:
          - 200

      - type: dsl
        dsl:
          - compare_versions(version, "< 12.5")
