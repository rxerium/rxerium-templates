id: CVE-2025-65964

info:
  name: CVE-2025-65964 - n8n Workflow Automation Vulnerability
  author: rxerium
  severity: low
  description: |
    n8n 0.123.1 through 1.119.1 contains a remote code execution caused by insufficient protection in pre-commit hooks via arbitrary Git configuration in Add Config operation, letting attackers execute commands on the host, exploit requires workflow creation or modification using Git node.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-65964
    - https://github.com/n8n-io/n8n/commit/d5a1171f95f75def5c3ac577707ab913e22aef04
    - https://github.com/n8n-io/n8n/releases/tag/n8n%401.119.2
    - https://github.com/n8n-io/n8n/security/advisories/GHSA-wpqc-h9wp-chmq
    - https://n8n-docs.teamlab.info/hosting/securing/blocking-nodes/#exclude-nodes
  metadata:
    vendor: n8n
    product: n8n Workflow Automation
    cvss-score: 0.0
    cwe-id: CWE-829
    verified: true
    shodan-query: http.favicon.hash:-831756631
  tags: cve,cve2025,n8n,workflow,rce

http:
  - method: GET
    path:
      - "{{BaseURL}}/signin"

    extractors:
      - type: regex
        name: base64_content
        group: 1
        regex:
          - '<meta name="n8n:config:sentry" content="([A-Za-z0-9+/=]+)"'
        internal: true

      - type: dsl
        name: decoded
        dsl:
          - 'base64_decode(base64_content)'
        internal: true

      - type: dsl
        name: version
        dsl:
          - 'replace_regex(decoded, ".*n8n@([0-9]+\\.[0-9]+\\.[0-9]+).*", "$1")'
        internal: true

      - type: dsl
        dsl:
          - '"n8n Version: " + version'

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "<title>n8n.io"
        case-insensitive: true

      - type: status
        status:
          - 200

      - type: dsl
        name: vulnerable
        dsl:
          - '(compare_versions(version, ">= 0.123.1") && compare_versions(version, "<= 1.119.1"))'
