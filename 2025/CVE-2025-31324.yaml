id: CVE-2025-31324

info:
  name: CVE-2025-31324 - SAP NetWeaver Visual Composer Unrestricted File Upload
  author: rxerium
  severity: critical
  description: |
    SAP NetWeaver Visual Composer Metadata Uploader contains a critical unrestricted file upload vulnerability due to missing authorization checks on the /developmentserver/metadatauploader endpoint. Unauthenticated remote attackers can upload arbitrary files (JSP, WAR, JAR, or executables) to the application server's filesystem and execute them with SAP Java stack privileges, often at administrator level. This zero-day vulnerability has been actively exploited since March 2025 by BianLian and RansomEXX ransomware groups. CISA added it to the Known Exploited Vulnerabilities catalogue on April 29, 2025, with a remediation deadline of May 20, 2025.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-31324
    - https://www.ionix.io/blog/exploited-sap-netweaver-visual-composer-unauthenticated-file-upload-vulnerability-cve-2025-31324/
    - https://www.paloaltonetworks.com/blog/security-operations/rapid-response-to-cve-2025-31324-mitigating-sap-netweaver-visual-composer-exploitation/
    - https://ccb.belgium.be/advisories/warning-critical-actively-exploited-improper-authorization-vulnerability-sap-netweaver
  metadata:
    verified: true
    max-request: 1
    vendor: SAP
    product: NetWeaver Visual Composer
    cvss-score: 10.0
    cwe-id: CWE-434
    cisa-kev: true
    shodan-query: http.favicon.hash:-266008933
  tags: cve,cve2025,kev,sap,file-upload,rce,zero-day

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    redirects: true
    max-redirects: 2
    matchers-condition: and
    matchers:
      - type: word
        part: header
        words:
          - "SAP NetWeaver Application Server"
        condition: or
        case-insensitive: true

      - type: regex
        part: header
        name: version-check
        regex:
          - (?i)SAP NetWeaver Application Server 7\.(0[0-9]|[1-4][0-9]|50)(\b|[^0-9])

    extractors:
      - type: kval
        part: header
        kval:
          - "server"