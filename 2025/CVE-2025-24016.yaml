id: CVE-2025-24016

info:
  name: CVE-2025-24016 - Wazuh Server Unsafe Deserialization Remote Code Execution
  author: rxerium
  severity: critical
  description: |
    Wazuh, a free and open-source threat prevention platform, contains a critical unsafe deserialization vulnerability affecting versions 4.4.0 through 4.9.0. The flaw exists in the DistributedAPI parameter handling where JSON-serialized data is deserialized using as_wazuh_object without proper sanitization. Attackers with API access or, in certain configurations, compromised agents can inject unsanitized dictionaries to forge unhandled exceptions and execute arbitrary Python code on Wazuh servers. Active exploitation by Mirai botnets has been observed since March 2025. CISA added this vulnerability to the Known Exploited Vulnerabilities catalogue. Version 4.9.1 contains the fix.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-24016
    - https://www.cve.org/CVERecord?id=CVE-2025-24016
    - https://www.cisa.gov/known-exploited-vulnerabilities-catalog
    - https://securityonline.info/critical-wazuh-rce-cve-2025-24016-actively-exploited-by-mirai-botnets/
    - https://github.com/rxerium/CVE-2025-24016
  metadata:
    max-request: 1
    vendor: Wazuh
    product: Wazuh Platform
    cvss-score: 9.9
    cwe-id: CWE-502
    cisa-kev: true
    verified: true
  tags: cve,cve2025,kev,wazuh,deserialization,rce

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}"
      - "{{BaseURL}}/app/login?"

    extractors:
      - type: regex
        name: wazuh_version
        part: body
        group: 1
        regex:
          - 'wazuhVersion(?:&quot;|"):&quot;?([0-9]+\.[0-9]+\.[0-9]+)'

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "<title>Wazuh</title>"
          - "wazuhVersion"
        part: body
        condition: and

      - type: dsl
        dsl:
          - compare_versions(version, '>= 4.4.0', '< 4.9.1')
