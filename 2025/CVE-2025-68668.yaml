id: CVE-2025-68668

info:
  name: CVE-2025-68668 - n8n Python Code Node Sandbox Bypass
  author: rxerium
  severity: critical
  description: |
    n8n versions 1.0.0 through 1.x (before 2.0.0) contain a critical sandbox bypass vulnerability in the Pyodide-based Python Code Node. The flaw allows authenticated users with permission to create or modify workflows to execute arbitrary operating system commands on the host running n8n, using the same privileges as the n8n process. This represents a protection mechanism failure (CWE-693) that can lead to complete system compromise. The vulnerability has been addressed in version 2.0.0, which uses a more secure task-runner implementation by default.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-68668
    - https://github.com/advisories/GHSA-62r4-hw23-cc8v
    - https://thehackernews.com/2026/01/new-n8n-vulnerability-99-cvss-lets.html
  metadata:
    vendor: n8n
    product: n8n Workflow Automation
    cvss-score: 9.9
    cwe-id: CWE-693
    verified: true
    shodan-query: http.favicon.hash:-831756631
  tags: cve,cve2025,n8n,workflow,rce,sandbox-bypass

http:
  - method: GET
    path:
      - "{{BaseURL}}/signin"

    extractors:
      - type: regex
        name: base64_content
        group: 1
        regex:
          - '<meta name="n8n:config:sentry" content="([A-Za-z0-9+/=]+)"'
        internal: true

      - type: dsl
        name: decoded
        dsl:
          - 'base64_decode(base64_content)'
        internal: true

      - type: dsl
        name: version
        dsl:
          - 'replace_regex(decoded, ".*n8n@([0-9]+\\.[0-9]+\\.[0-9]+).*", "$1")'
        internal: true

      - type: dsl
        dsl:
          - '"n8n Version: " + version'

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "<title>n8n.io"
        case-insensitive: true

      - type: status
        status:
          - 200

      - type: dsl
        name: vulnerable
        dsl:
          - '(compare_versions(version, ">= 1.0.0") && compare_versions(version, "< 2.0.0"))'

# n8n said it had introduced task runner-based native Python implementation in version 1.111.0 as an optional feature for improved security isolation. This template does not check for that and cannot confirm whether the remote host has configured this on their n8n instance so please proceed with that in mind when using this template.