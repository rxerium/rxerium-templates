id: CVE-2025-20337

info:
  name: CVE-2025-20337 - Cisco Identity Services Engine Unauthenticated Remote Code Execution
  author: rxerium
  severity: critical
  description: |
    Cisco Identity Services Engine (ISE) versions 3.3 and 3.4, and ISE Passive Identity Connector (ISE-PIC) versions 3.1.0 through 3.4.0 contain a critical vulnerability stemming from insufficient validation of user-supplied input in a specific API. Unauthenticated remote attackers can exploit this flaw by sending crafted API requests to execute arbitrary code with root privileges. With a CVSS score of 10.0, this represents maximum severity. CISA added this vulnerability to the Known Exploited Vulnerabilities catalogue on July 28, 2025, confirming active exploitation in the wild. This template provides indirect detection using timestamp analysis.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-20337
    - https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ise-unauth-rce-ZAd2GnJ6
    - https://securityaffairs.com/180044/security/cisco-patches-critical-cve-2025-20337-bug-in-identity-services-engine-with-cvss-10-severity.html
  metadata:
    verified: true
    max-request: 1
    vendor: Cisco
    product: Identity Services Engine
    cvss-score: 10.0
    cwe-id: CWE-269
    cisa-kev: true
    shodan-query:
      - html:"Identity Services Engine"
  tags: cve,cve2025,kev,cisco,ise,rce

http:
  - method: GET
    path:
      - "{{BaseURL}}/admin/login.jsp"

    extractors:
      - type: regex
        name: timestamp
        part: body
        regex:
          - "\\?_isever=(\\d{10})"
        group: 1
        internal: true

      - type: dsl
        name: date
        dsl:
          - "date_time('%D-%M-%Y', timestamp)" 

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: body
        words:
          - "Identity Services Engine"

      - type: dsl
        name: pre-july-16-2025
        dsl:
          - compare_versions(timestamp, '< 1752710400')
