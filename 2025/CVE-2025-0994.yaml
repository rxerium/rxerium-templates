id: CVE-2025-0994

info:
  name: CVE-2025-0994 - Trimble Cityworks Deserialization Remote Code Execution
  author: rxerium
  severity: critical
  description: |
    Trimble Cityworks versions prior to 15.8.9 and Cityworks with Office Companion versions prior to 23.10 contain a critical deserialization vulnerability that allows authenticated attackers to perform remote code execution against Microsoft Internet Information Services (IIS) web servers. This vulnerability has been actively exploited in the wild, with threat actors deploying Rust-based loaders launching Cobalt Strike and Go-based remote access tool VShell. CISA has confirmed active exploitation and added this vulnerability to the Known Exploited Vulnerabilities catalogue.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-0994
    - https://www.cisa.gov/news-events/ics-advisories/icsa-25-037-04
    - https://censys.com/advisory/cve-2025-0994
    - https://thehackernews.com/2025/02/cisa-warns-of-active-exploitation-in.html
  metadata:
    max-request: 1
    vendor: Trimble
    product: Cityworks
    cvss-score: 8.6
    cwe-id: CWE-502
    cisa-kev: true
    verified: true
  tags: cve,cve2025,kev,cityworks,deserialization,rce

http:
  - method: GET
    path:
      - "{{BaseURL}}"
      - "{{BaseURL}}/Cityworks/Login.aspx"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: body
        words:
          - "Cityworks"

      - type: dsl
        dsl:
          - "compare_versions(version, '<15.8.9')"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - 'Cityworks ([0-9.]+) - Revision [0-9.]+'
        internal: true

      - type: kval
        kval:
          - version
