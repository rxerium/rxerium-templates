id: CVE-2025-49113

info:
  name: CVE-2025-49113 - Roundcube Webmail PHP Object Deserialization RCE
  author: rxerium
  severity: critical
  description: |
    Roundcube Webmail versions prior to 1.5.10 and 1.6.0-1.6.10 contain a critical PHP object deserialization vulnerability in the upload.php file. Authenticated users can trigger remote code execution through improper validation of the _from parameter in program/actions/settings/upload.php. The flaw affects all Roundcube versions released over the past decade, impacting approximately 2.5 million potentially vulnerable devices. Discovered by Kirill Firsov and disclosed on June 1, 2025, exploits are actively being sold in underground forums with an EPSS score of 81 indicating extremely high probability of exploitation.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-49113
    - https://www.offsec.com/blog/cve-2025-49113/
    - https://socradar.io/cve-2025-49113-roundcube-vulnerability-rce/
    - https://github.com/hakaioffsec/CVE-2025-49113-exploit
  metadata:
    vendor: Roundcube
    product: Roundcube Webmail
    cvss-score: 9.9
    cwe-id: CWE-502
    cisa-kev: false
    verified: true
  tags: cve,cve2025,roundcube,deserialization,rce,zero-day

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    extractors:
      - type: regex
        name: major
        group: 1
        regex:
          - '"rcversion":(\d)'
        internal: true

      - type: regex
        name: minor
        group: 1
        regex:
          - '"rcversion":\d\d(\d)'
        internal: true

      - type: regex
        name: patch
        group: 1
        regex:
          - '"rcversion":\d\d\d(\d+)'
        internal: true

      - type: dsl
        name: version
        dsl:
          - major + "." + minor + "." + patch
        internal: true

      - type: dsl
        dsl:
          - '"Roundcube Version: "+ version'

    matchers-condition: and
    matchers:
      - type: dsl
        name: vulnerable
        dsl:
          - compare_versions(version, '< 1.5.10') || (compare_versions(version,'>= 1.6.0') && compare_versions(version, '< 1.6.11'))

      - type: word
        part: body
        words:
          - "Roundcube"

      - type: status
        status:
          - 200
