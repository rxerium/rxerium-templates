id: CVE-2025-26465

info:
  name: CVE-2025-26465 - OpenSSH Host Key Verification Man-in-the-Middle
  author: rxerium
  severity: high
  description: |
    OpenSSH client versions 6.8p1 through 9.9p1 contain a logic error in host key verification when the VerifyHostKeyDNS option is enabled. The vulnerability stems from mishandling error codes during host key verification, allowing malicious actors to impersonate legitimate servers through man-in-the-middle attacks. For successful exploitation, attackers must first exhaust the client's memory resources, increasing attack complexity. This flaw affects approximately 3.5 million internet-facing OpenSSH servers. Patched in OpenSSH 9.9p2.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-26465
    - https://thehackernews.com/2025/02/new-openssh-flaws-enable-man-in-middle.html
    - https://www.upwind.io/feed/openssh-vulnerabilities-cve-2025-26465-and-cve-2025-26466-enable-man-in-the-middle-and-dos-attacks
    - https://socprime.com/blog/cve-2025-26465-cve-2025-26466-vulnerabilities/
  metadata:
    max-request: 1
    vendor: OpenBSD
    product: OpenSSH
    cvss-score: 6.8
    cwe-id: CWE-390
    cisa-kev: false
    verified: true
  tags: cve,cve2025,ssh,openssh,mitm

tcp:
  - host:
      - "{{Hostname}}"
    port: 22

    matchers:
      - type: word
        words:
          - "SSH-2.0-OpenSSH_6.8p1"
          - "SSH-2.0-OpenSSH_6.9p1"
          - "SSH-2.0-OpenSSH_7.0p1"
          - "SSH-2.0-OpenSSH_7.1p1"
          - "SSH-2.0-OpenSSH_7.2p1"
          - "SSH-2.0-OpenSSH_7.3p1"
          - "SSH-2.0-OpenSSH_7.4p1"
          - "SSH-2.0-OpenSSH_7.5p1"
          - "SSH-2.0-OpenSSH_7.6p1"
          - "SSH-2.0-OpenSSH_7.7p1"
          - "SSH-2.0-OpenSSH_7.8p1"
          - "SSH-2.0-OpenSSH_7.9p1"
          - "SSH-2.0-OpenSSH_8.0p1"
          - "SSH-2.0-OpenSSH_8.1p1"
          - "SSH-2.0-OpenSSH_8.2p1"
          - "SSH-2.0-OpenSSH_8.3p1"
          - "SSH-2.0-OpenSSH_8.4p1"
          - "SSH-2.0-OpenSSH_8.5p1"
          - "SSH-2.0-OpenSSH_8.6p1"
          - "SSH-2.0-OpenSSH_8.7p1"
          - "SSH-2.0-OpenSSH_8.8p1"
          - "SSH-2.0-OpenSSH_8.9p1"
          - "SSH-2.0-OpenSSH_9.0p1"
          - "SSH-2.0-OpenSSH_9.1p1"
          - "SSH-2.0-OpenSSH_9.2p1"
          - "SSH-2.0-OpenSSH_9.3p1"
          - "SSH-2.0-OpenSSH_9.4p1"
          - "SSH-2.0-OpenSSH_9.5p1"
          - "SSH-2.0-OpenSSH_9.6p1"
          - "SSH-2.0-OpenSSH_9.7p1"
          - "SSH-2.0-OpenSSH_9.8p1"
          - "SSH-2.0-OpenSSH_9.9p1"
