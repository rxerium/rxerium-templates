id: CVE-2025-30220

info:
  name: CVE-2025-30220 - GeoServer WFS Service XML External Entity Processing
  author: rxerium
  severity: critical
  description: |
    GeoServer versions prior to 2.27.1, 2.26.3, and 2.25.7 contain a critical XML External Entity (XXE) vulnerability in the WFS service. Insufficient entity resolution validation in the GeoTools XSD library bypasses AllowListEntityResolver security controls, enabling attackers to trigger parsing of external DTDs and entities. This allows Out-of-Band data exfiltration of local files accessible by the GeoServer process and Server-Side Request Forgery attacks. The vulnerability affects approximately 2.5 million potentially vulnerable devices and can be exploited without authentication.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-30220
    - https://github.com/geoserver/geoserver/security/advisories/GHSA-jj54-8f66-c5pc
    - https://geoserver.org/vulnerability/2025/06/10/cve-disclosure.html
    - https://kudelskisecurity.com/research/xml-external-entity-xxe-processing-vulnerability-in-geoserver-wfs-service-cve-2025-30220
  metadata:
    max-request: 2
    vendor: OSGeo
    product: GeoServer
    cvss-score: 9.9
    cwe-id: CWE-611
    cisa-kev: false
    verified: true
    shodan-query:
      - 'http.title:"GeoServer: Redirecting"'
      - 'http.html_hash:1093634893 "Content-Disposition: inline"'
  tags: cve,cve2025,geoserver,xxe,ssrf

http:
  - method: GET
    path:
      - "{{BaseURL}}/geoserver/web/wicket/resource/org.geoserver.web.GeoServerBasePage/img/logo.png"
      - "{{BaseURL}}/web/wicket/resource/org.geoserver.web.GeoServerBasePage/img/logo.png"

    extractors:      
      - type: kval
        name: date
        part: header
        kval:
          - last_modified

      - type: dsl
        name: last_modified_ts
        dsl:
          - to_unix_time(date, "Mon, 02 Jan 2006 15:04:05 MST")
        internal: true

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: dsl
        dsl:
          - sha256(body)=="24738974cad3b3887d11c118248e625da82ca89c8fd21f5bc978d6a29888ebb6"

      - type: dsl
        dsl:
          - compare_versions(last_modified_ts, "< 1754908800")
