id: CVE-2026-25049

info:
  name: CVE-2026-25049 - n8n Expression Injection Leading to RCE
  author: rxerium
  severity: critical
  description: |
    An authenticated user with permission to create or modify workflows in n8n could abuse crafted expressions in workflow parameters to trigger unintended system command execution on the host running n8n. This issue has been patched in versions 1.123.17 and 2.5.2.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2026-25049
    - https://github.com/n8n-io/n8n/security/advisories/GHSA-6cqr-8cfr-67f8
    - https://github.com/n8n-io/n8n/commit/7860896909b3d42993a36297f053d2b0e633235d
    - https://github.com/n8n-io/n8n/commit/936c06cfc1ad269a89e8ef7f8ac79c104436d54b
  metadata:
    vendor: n8n
    product: n8n
    cvss-score: 9.4
    cwe-id: CWE-913
    cisa-kev: false
    verified: true
    shodan-query: http.favicon.hash:-831756631
  tags: cve,cve2026,n8n,expression-injection,rce,authenticated

http:
  - method: GET
    path:
      - "{{BaseURL}}/signin"

    extractors:
      - type: regex
        name: base64_content
        group: 1
        regex:
          - '<meta name="n8n:config:sentry" content="([A-Za-z0-9+/=]+)"'
        internal: true

      - type: dsl
        name: decoded
        dsl:
          - 'base64_decode(base64_content)'
        internal: true

      - type: dsl
        name: version
        dsl:
          - 'replace_regex(decoded, ".*n8n@([0-9]+\\.[0-9]+\\.[0-9]+).*", "$1")'
        internal: true

      - type: dsl
        dsl:
          - '"n8n Version: " + version'

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "<title>n8n.io"
        case-insensitive: true

      - type: status
        status:
          - 200

      - type: dsl
        name: vulnerable
        dsl:
          - 'compare_versions(version, "< 1.123.17") || (compare_versions(version, ">= 2.0.0") && compare_versions(version, "< 2.5.2"))'
