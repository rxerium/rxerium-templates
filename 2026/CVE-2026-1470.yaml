id: CVE-2026-1470

info:
  name: >
    n8n Workflow Expression Evaluation - Remote Code Execution
  author: rxerium
  severity: critical
  description: >
    n8n contains a Remote Code Execution (RCE) vulnerability in its workflow Expression evaluation system. Expressions supplied by authenticated users during workflow configuration may be evaluated in an execution context that is not sufficiently isolated from the underlying runtime. This means that an authenticated attacker could abuse this behavior to execute arbitrary code with the privileges of the n8n application. The vulnerability has a CVSS score of 9.9 (Critical) and could allow authenticated attackers to gain complete control over the n8n instance.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2026-1470
    - https://www.thehackerwire.com/n8n-workflow-rce-cve-2026-1470/
  metadata:
    vendor: n8n
    product: n8n
    cvss-score: 9.9
    verified: true
    shodan-query: http.favicon.hash:-831756631
  tags: cve,cve2026,n8n,rce,workflow,authenticated,critical

http:
  - method: GET
    path:
      - "{{BaseURL}}/signin"

    extractors:
      - type: regex
        name: base64_content
        group: 1
        regex:
          - '<meta name="n8n:config:sentry" content="([A-Za-z0-9+/=]+)"'
        internal: true

      - type: dsl
        name: decoded
        dsl:
          - 'base64_decode(base64_content)'
        internal: true

      - type: dsl
        name: version
        dsl:
          - 'replace_regex(decoded, ".*n8n@([0-9]+\\.[0-9]+\\.[0-9]+).*", "$1")'
        internal: true

      - type: dsl
        dsl:
          - '"n8n Version: " + version'

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "<title>n8n.io"
        case-insensitive: true

      - type: status
        status:
          - 200

      - type: dsl
        name: vulnerable
        dsl:
          - 'compare_versions(version, "<= 1.123.17") || compare_versions(version, "<= 2.4.5") || compare_versions(version, "<= 2.5.1")'
