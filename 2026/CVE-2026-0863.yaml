id: CVE-2026-0863

info:
  name: >
    n8n Python Task Executor - Sandbox Bypass leading to Remote Code Execution
  author: rxerium
  severity: critical
  description: >
    A sandbox bypass vulnerability exists in n8n's python-task-executor that allows attackers to use string formatting and exception handling to run arbitrary unrestricted Python code in the underlying operating system. The vulnerability can be exploited via the Code block by an authenticated user with basic permissions and can lead to a full n8n instance takeover on instances operating under "Internal" execution mode. If the instance is operating under the "External" execution mode (e.g., n8n's official Docker image), arbitrary code execution occurs inside a Sidecar container and not the main node, which significantly reduces the vulnerability impact. This vulnerability is exploitable over a network without physical access and no user interaction is necessary for exploitation.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2026-0863
    - https://cve.akaoma.com/cve-2026-0863
    - https://www.tenable.com/cve/CVE-2026-0863
  metadata:
    vendor: n8n
    product: n8n
    cwe-id: CWE-94
    verified: true
    shodan-query: http.favicon.hash:-831756631
  tags: cve,cve2026,n8n,rce,sandbox-bypass,python,authenticated,critical

http:
  - method: GET
    path:
      - "{{BaseURL}}/signin"

    extractors:
      - type: regex
        name: base64_content
        group: 1
        regex:
          - '<meta name="n8n:config:sentry" content="([A-Za-z0-9+/=]+)"'
        internal: true

      - type: dsl
        name: decoded
        dsl:
          - 'base64_decode(base64_content)'
        internal: true

      - type: dsl
        name: version
        dsl:
          - 'replace_regex(decoded, ".*n8n@([0-9]+\\.[0-9]+\\.[0-9]+).*", "$1")'
        internal: true

      - type: dsl
        dsl:
          - '"n8n Version: " + version'

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "<title>n8n.io"
        case-insensitive: true

      - type: status
        status:
          - 200

      - type: dsl
        name: vulnerable
        dsl:
          - 'compare_versions(version, "<= 1.123.14") || compare_versions(version, "<= 2.3.5") || compare_versions(version, "<= 2.4.2")'
