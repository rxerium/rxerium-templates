id: CVE-2026-21877

info:
  name: CVE-2026-21877 - n8n Remote Code Execution via Arbitrary File Write
  author: rxerium
  severity: critical
  description: |
    n8n versions >= 0.123.0 and < 1.121.3 contain a critical authenticated remote code execution vulnerability. An authenticated user can exploit an arbitrary file write vulnerability to overwrite critical files and execute untrusted code on the n8n server, potentially leading to full system compromise. The vulnerability affects both self-hosted and n8n Cloud instances, posing significant risk to environments where n8n automates workflows with access to internal systems, credentials, and sensitive data. Administrators unable to patch should disable the Git node to reduce exposure.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2026-21877
    - https://github.com/advisories/GHSA-v364-rw7m-3263
  metadata:
    vendor: n8n
    product: n8n Workflow Automation
    cvss-score: 10.0
    cwe-id: CWE-94
    verified: true
    shodan-query: http.favicon.hash:-831756631
  tags: cve,cve2026,n8n,workflow,rce,authenticated

http:
  - method: GET
    path:
      - "{{BaseURL}}/signin"

    extractors:
      - type: regex
        name: base64_content
        group: 1
        regex:
          - '<meta name="n8n:config:sentry" content="([A-Za-z0-9+/=]+)"'
        internal: true

      - type: dsl
        name: decoded
        dsl:
          - 'base64_decode(base64_content)'
        internal: true

      - type: dsl
        name: version
        dsl:
          - 'replace_regex(decoded, ".*n8n@([0-9]+\\.[0-9]+\\.[0-9]+).*", "$1")'
        internal: true

      - type: dsl
        dsl:
          - '"n8n Version: " + version'

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "<title>n8n.io"
        case-insensitive: true

      - type: status
        status:
          - 200

      - type: dsl
        name: vulnerable
        dsl:
          - '(compare_versions(version, ">= 0.123.0") && compare_versions(version, "< 1.121.3"))'
