id: CVE-2023-40000

info:
  name: CVE-2023-40000 - LiteSpeed Cache WordPress Plugin XSS
  author: rxerium,sorrowx3
  severity: medium
  description: |
    Improper Neutralization of Input During Web Page Generation vulnerability in LiteSpeed Technologies LiteSpeed Cache allows Stored XSS. The LiteSpeed Cache plugin for WordPress versions up to and including 5.7 is affected by a cross-site scripting vulnerability that enables attackers to inject malicious scripts that persist in the application, potentially compromising site integrity and user data. The vulnerability results from lack of user input sanitization in the update_cdn_status() function.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2023-40000
    - https://thehackernews.com/2024/02/wordpress-litespeed-plugin.html
    - https://wordpress.org/plugins/litespeed-cache
    - https://patchstack.com/database/vulnerability/litespeed-cache/wordpress-litespeed-cache-plugin-6-5-1-privilege-escalation-vulnerability
    - https://www.wordfence.com/blog/2024/08/over-5000000-site-owners-affected-by-critical-privilege-escalation-vulnerability-patched-in-litespeed-cache-plugin/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2023-40000
    cwe-id: CWE-79
  metadata:
    fofa-query: "wp-content/plugins/litespeed-cache/"
    google-query: inurl:"/wp-content/plugins/litespeed-cache/"
    shodan-query: 'vuln:CVE-2023-40000'
    vendor: LiteSpeed Technologies
    product: LiteSpeed Cache
    cvss-score: 6.1
    cisa-kev: false
    verified: true
  tags: cve,cve2023,wordpress,wp-plugin,litespeed-cache,xss

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/litespeed-cache/readme.txt"

    extractors:
      - type: regex
        part: body
        internal: true
        group: 1
        regex:
          - '(?i)Stable.tag:\s?([\w.]+)'

      - type: regex
        part: body
        group: 1
        regex:
          - '(?i)Stable.tag:\s?([\w.]+)'

    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - compare_versions(internal_detected_version, concat("< 5.7.0.1"))

      - type: status
        status:
          - 200

      - type: word
        words:
          - "litespeed-cache"
        part: body