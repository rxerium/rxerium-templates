id: CVE-2023-22515

info:
  name: CVE-2023-22515 - Atlassian Confluence Broken Access Control
  author: rxerium
  severity: critical
  description: Atlassian Confluence Data Center and Server versions 8.0.0-8.3.2, 8.4.0-8.4.2, and 8.5.0-8.5.1 are affected by a critical broken access control vulnerability. Unauthenticated remote attackers can exploit this vulnerability to create unauthorized Confluence administrator accounts and access Confluence instances without authentication. This zero-day vulnerability has been actively exploited in the wild by threat actors to gain initial access to networks.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2023-22515
    - https://confluence.atlassian.com/security/cve-2023-22515-broken-access-control-vulnerability-in-confluence-data-center-and-server-1295682276.html
    - https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-289a
    - https://www.rapid7.com/blog/post/2023/10/04/etr-cve-2023-22515-zero-day-privilege-escalation-in-confluence-server-and-data-center/
  metadata:
    max-request: 1
    vendor: Atlassian
    product: Confluence Data Center and Server
    cvss-score: 9.8
    cwe-id: CWE-20
    cisa-kev: true
    verified: true
  tags: cve,cve2023,atlassian,confluence,auth-bypass,kev

http:
  - method: GET
    path:
      - "{{BaseURL}}/dologin.action"
      - "{{BaseURL}}"
      - "{{BaseURL}}/pages"
      - "{{BaseURL}}/confluence"
      - "{{BaseURL}}/wiki"

    host-redirects: true
    stop-at-first-match: true

    matchers:

      - type: regex
        regex:
          - "8.0.0$"
          - "8.0.1$"
          - "8.0.2$"
          - "8.0.3$"
          - "8.0.4$"
          - "8.1.0$"
          - "8.1.1$"
          - "8.1.3$"
          - "8.1.4$"
          - "8.2.0$"
          - "8.2.1$"
          - "8.2.2$"
          - "8.2.3$"
          - "8.3.0$"
          - "8.3.1$"
          - "8.3.2$"
          - "8.4.0$"
          - "8.4.1$"
          - "8.4.2$"
          - "8.5.0$"
          - "8.5.1$"
        part: version

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - '<meta name="ajs-version-number" content="(.*)">'
          - 'Atlassian Confluence ([a-z0-9-._]+)'
        internal: true

      - type: kval
        kval:
          - version