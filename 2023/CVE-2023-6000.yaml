id: CVE-2023-6000

info:
  name: CVE-2023-6000 - Popup Builder WordPress Plugin Stored XSS
  author: rxerium
  severity: medium
  description: |
    The Popup Builder WordPress plugin before version 4.2.3 is affected by a stored cross-site scripting vulnerability. The plugin fails to restrict unauthorized users from modifying existing popups and embedding JavaScript code within them, enabling stored XSS attacks. Attackers can inject malicious scripts that execute when other users view the compromised popups. This vulnerability has been actively exploited in the wild by the Balada Injector malware campaign, which infected over 7,100 WordPress sites using this flaw.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2023-6000
    - https://github.com/rxerium/CVE-2023-6000
    - https://wpscan.com/vulnerability/cdb3a8bd-4ee0-4ce0-9029-0490273bcfc8/
    - https://thehackernews.com/2024/01/balada-injector-infects-over-7100.html
  metadata:
    max-request: 1
    vendor: Sygnoos
    product: Popup Builder
    cvss-score: 6.1
    cwe-id: CWE-79
    cisa-kev: false
    verified: true
  tags: cve,cve2023,wordpress,wp-plugin,xss

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/popup-builder/readme.txt"

    extractors:
      - type: regex
        part: body
        internal: true
        group: 1
        regex:
          - '(?i)Stable.tag:\s?([\w.]+)'

      - type: regex
        part: body
        group: 1
        regex:
          - '(?i)Stable.tag:\s?([\w.]+)'

    matchers-condition: or
    matchers:
      - type: dsl
        dsl:
          - compare_versions(internal_detected_version, concat("< 4.2.3"))

      - type: regex
        part: body
        regex:
          - '(?i)Stable.tag:\s?([\w.]+)'