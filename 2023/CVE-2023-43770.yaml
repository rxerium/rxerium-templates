id: CVE-2023-43770

info:
  name: CVE-2023-43770 - Roundcube Webmail Cross-Site Scripting
  author: rxerium
  severity: medium
  description: |
    Roundcube Webmail versions before 1.4.14, 1.5.x before 1.5.4, and 1.6.x before 1.6.3 allow XSS via linkrefs in plain text messages. This persistent cross-site scripting vulnerability allows attackers to obtain sensitive information through specially crafted links in plain text messages. The vulnerability was added to CISA's Known Exploited Vulnerabilities catalog in February 2024 due to active exploitation by Russian threat actors including APT28 and Winter Vivern. The vulnerability was fixed on September 15, 2023, but continued to be exploited in the wild months after the patch was released.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2023-43770
    - https://www.wiz.io/vulnerability-database/cve/cve-2023-43770
    - https://www.helpnetsecurity.com/2024/02/13/cve-2023-43770/
    - https://www.cisa.gov/known-exploited-vulnerabilities-catalog
    - https://roundcube.net/news/2023/09/15/security-updates-1.6.3-1.5.4-and-1.4.14
  metadata:
    vendor: Roundcube
    product: Roundcube Webmail
    cvss-score: 6.1
    cwe-id: CWE-79
    cisa-kev: true
    verified: true
  tags: cve,cve2023,kev,roundcube,xss

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    extractors:
      - type: regex
        name: major
        group: 1
        regex:
          - '"rcversion":(\d)'
        internal: true

      - type: regex
        name: minor
        group: 1
        regex:
          - '"rcversion":\d\d(\d)'
        internal: true

      - type: regex
        name: patch
        group: 1
        regex:
          - '"rcversion":\d\d\d(\d+)'
        internal: true

      - type: dsl
        name: version
        dsl:
          - major + "." + minor + "." + patch
        internal: true

      - type: dsl
        dsl:
          - '"Roundcube Version: "+ version'

    matchers-condition: and
    matchers:
      - type: dsl
        name: vulnerable
        dsl:
          - compare_versions(version, '< 1.4.14') || (compare_versions(version,'>= 1.5.0') && compare_versions(version, '< 1.5.4')) || (compare_versions(version,'>= 1.6.0') && compare_versions(version, '< 1.6.3'))

      - type: word
        part: body
        words:
          - "Roundcube"

      - type: status
        status:
          - 200
