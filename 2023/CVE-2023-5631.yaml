id: CVE-2023-5631

info:
  name: CVE-2023-5631 - Roundcube Webmail Stored Cross-Site Scripting
  author: rxerium
  severity: medium
  description: |
    Roundcube Webmail versions before 1.4.15, 1.5.x before 1.5.5, and 1.6.x before 1.6.4 allow stored XSS via an HTML e-mail message with a crafted SVG document. The vulnerability exists in program/lib/Roundcube/rcube_washtml.php behavior which fails to properly sanitize SVG content embedded in HTML emails. This vulnerability was exploited by threat actor Winter Vivern to target government entities and organizations in targeted espionage campaigns.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2023-5631
    - https://www.wiz.io/vulnerability-database/cve/cve-2023-5631
    - https://news.cpanel.com/roundcube-stored-xss-cve-2023-5631-cve-2023-43770/
    - https://www.prio-n.com/blog/roundcubes-cve-2023-5631-vulnerability-a-target-for-threat-actor-winter-vivern
    - https://support.plesk.com/hc/en-us/articles/18573638599831-CVE-2023-5631-vulnerability-in-Roundcube
  metadata:
    vendor: Roundcube
    product: Roundcube Webmail
    cvss-score: 6.1
    cwe-id: CWE-79
    cisa-kev: false
    verified: true
  tags: cve,cve2023,roundcube,xss

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    extractors:
      - type: regex
        name: major
        group: 1
        regex:
          - '"rcversion":(\d)'
        internal: true

      - type: regex
        name: minor
        group: 1
        regex:
          - '"rcversion":\d\d(\d)'
        internal: true

      - type: regex
        name: patch
        group: 1
        regex:
          - '"rcversion":\d\d\d(\d+)'
        internal: true

      - type: dsl
        name: version
        dsl:
          - major + "." + minor + "." + patch
        internal: true

      - type: dsl
        dsl:
          - '"Roundcube Version: "+ version'

    matchers-condition: and
    matchers:
      - type: dsl
        name: vulnerable
        dsl:
          - compare_versions(version, '< 1.4.15') || (compare_versions(version,'>= 1.5.0') && compare_versions(version, '< 1.5.5')) || (compare_versions(version,'>= 1.6.0') && compare_versions(version, '< 1.6.4'))

      - type: word
        part: body
        words:
          - "Roundcube"

      - type: status
        status:
          - 200
