id: CVE-2023-0669

info:
  name: CVE-2023-0669 - Fortra GoAnywhere MFT Remote Code Execution
  author: rxerium
  severity: high
  description: |
    GoAnywhere MFT versions prior to 7.1.2 contain a pre-authentication command injection vulnerability in the License Response Servlet. This vulnerability was exploited by the Clop ransomware group in January 2023, resulting in data breaches for 130 companies using GoAnywhere MFT. The vulnerability allows unauthenticated attackers to achieve remote code execution on affected systems.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2023-0669
    - https://www.goanywhere.com/support/advisory/68x
    - https://www.rapid7.com/blog/post/2023/02/03/exploitation-of-goanywhere-mft-zero-day-vulnerability/
    - https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-158a
  metadata:
    max-request: 1
    vendor: Fortra
    product: GoAnywhere MFT
    cvss-score: 7.2
    cwe-id: CWE-77
    cisa-kev: true
    verified: true
  tags: cve,cve2023,kev,goanywhere,mft,rce

http:
  - method: GET
    path:
      - "{{BaseURL}}"
      - "{{BaseURL}}/goanywhere/auth/Login.xhtml"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: body
        words:
          - "GoAnywhere"

      - type: dsl
        dsl:
          - "compare_versions(version, '<7.1.2')"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - 'GoAnywhere[^0-9]+([0-9]+\.[0-9]+\.[0-9]+)'
        internal: true

      - type: kval
        kval:
          - version
