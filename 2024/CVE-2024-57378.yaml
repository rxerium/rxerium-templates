id: CVE-2024-57378

info:
  name: CVE-2024-57378 - Wazuh SIEM Broken Access Control
  author: rxerium
  severity: high
  description: Wazuh SIEM version 4.8.2 is affected by a broken access control vulnerability due to improper access control mechanisms. This security flaw enables attackers to create internal user accounts without proper role assignment, bypassing normal authentication controls. The vulnerability potentially enables unauthorized privilege escalation and access to sensitive resources within the SIEM platform, impacting confidentiality, integrity, and availability of the system.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-57378
    - https://www.cvedetails.com/vulnerability-list/vendor_id-19545/product_id-51675/Wazuh-Wazuh.html
  metadata:
    max-request: 1
    vendor: Wazuh
    product: Wazuh SIEM
    cvss-score: 7.3
    cwe-id: CWE-284
    cisa-kev: false
    verified: true
  tags: cve,cve2024,wazuh,access-control

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}"
      - "{{BaseURL}}/app/login?"

    extractors:
      - type: regex
        name: wazuh_version
        part: body
        group: 1
        regex:
          - 'wazuhVersion(?:&quot;|"):&quot;?([0-9]+\.[0-9]+\.[0-9]+)'

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "<title>Wazuh</title>"
          - "wazuhVersion"
        part: body
        condition: and

      - type: dsl
        dsl:
          - compare_versions(version, >= 4.8.2')
