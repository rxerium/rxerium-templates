id: CVE-2024-0204

info:
  name: CVE-2024-0204 - Fortra GoAnywhere MFT Authentication Bypass
  author: rxerium
  severity: critical
  description: |
    Fortra GoAnywhere MFT versions prior to 7.4.1 contain a critical authentication bypass vulnerability that allows unauthorized users to create admin users via the admin portal. The vulnerability enables remote attackers to bypass authentication requirements and gain administrative access to the system without valid credentials. This flaw poses a significant risk to organizations using affected versions.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-0204
    - https://www.goanywhere.com/support/advisory/68x
    - https://www.rapid7.com/blog/post/2024/01/23/etr-cve-2024-0204-critical-authentication-bypass-in-fortra-goanywhere-mft/
    - https://www.fortra.com/security/advisories/product-security/fi-2024-002
  metadata:
    max-request: 1
    vendor: Fortra
    product: GoAnywhere MFT
    cvss-score: 9.8
    cwe-id: CWE-287
    verified: true
  tags: cve,cve2024,goanywhere,mft,auth-bypass

http:
  - method: GET
    path:
      - "{{BaseURL}}"
      - "{{BaseURL}}/goanywhere/auth/Login.xhtml"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: body
        words:
          - "GoAnywhere"

      - type: dsl
        dsl:
          - "compare_versions(version, '<7.4.1')"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - 'GoAnywhere[^0-9]+([0-9]+\.[0-9]+\.[0-9]+)'
        internal: true

      - type: kval
        kval:
          - version
