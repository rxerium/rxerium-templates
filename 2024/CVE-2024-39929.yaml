id: CVE-2024-39929

info:
  name: CVE-2024-39929 - Exim Mail Server RFC 2231 Header Parsing Bypass
  author: rxerium
  severity: medium
  description: |
    Exim mail transfer agent through version 4.97.1 contains a parsing defect in handling multiline RFC 2231-compliant email headers. This vulnerability allows remote attackers to bypass the $mime_filename extension-blocking protection mechanism, potentially enabling delivery of executable attachments to end-user mailboxes despite security filters. The flaw affects approximately 1.5 million publicly exposed Exim servers running vulnerable versions, with proof-of-concept exploits available.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-39929
    - https://thehackernews.com/2024/07/critical-exim-mail-server-vulnerability.html
    - https://censys.com/advisory/cve-2024-39929
    - https://github.com/michael-david-fry/CVE-2024-39929
  metadata:
    max-request: 1
    vendor: Exim
    product: Exim Mail Transfer Agent
    cvss-score: 5.4
    cwe-id: CWE-116
    cisa-kev: false
    verified: true
  tags: cve,cve2024,exim,mail,filter-bypass
tcp:
  - inputs:
      - data: "\n"

    host:
      - "{{Hostname}}"
    port: 465,587

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "ESMTP Exim"

      - type: word
        words:
          - "4.97.1"
          - "4.97"
          - "4.96"
          - "4.95"
          - "4.94"
          - "4.93"
          - "4.92"
          - "4.91"
          - "4.90"
          - "4.89"
          - "4.88"
          - "4.87"
          - "4.86"
          - "4.85"
          - "4.84"
          - "4.83"
          - "4.82"
          - "4.81"
          - "4.80"
          - "4.79"
          - "4.78"
          - "4.77"
          - "4.76"
          - "4.75"
          - "4.74"
          - "4.73"
          - "4.72"
          - "4.71"
          - "4.70"
          - "4.69"
          - "4.68"
          - "4.67"
          - "4.66"
          - "4.65"
          - "4.64"
          - "4.63"
          - "4.62"
          - "4.61"
          - "4.50"
          - "4.40"
          - "4.30"
          - "4.20"
          - "4.10"
          - "4.00"
          - "3.30"
          - "3.20"
          - "3.10"
          - "3.00"
          - "2.10"
          - "2.00"
          - "1.90"
        part: version

    extractors:
      - type: regex
        group: 1
        regex:
          - '(?i)SMTP.Exim\s?([\w.]+)'