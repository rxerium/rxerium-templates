id: CVE-2024-42009

info:
  name: CVE-2024-42009 - Roundcube Webmail Cross-Site Scripting
  author: rxerium
  severity: critical
  description: |
    Roundcube Webmail versions through 1.5.7 and 1.6.x through 1.6.7 contain a critical cross-site scripting (XSS) vulnerability that allows a remote attacker to steal and send emails of a victim via a crafted e-mail message. The vulnerability abuses a desanitization issue in message_body() in program/actions/mail/show.php. This vulnerability was added to CISA's Known Exploited Vulnerabilities catalog on June 9, 2025, and has been actively exploited by UNC1151 (associated with Belarusian government) and Russian intelligence services to steal user credentials in spearphishing campaigns.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-42009
    - https://github.com/advisories/GHSA-j43g-prf4-578j
    - https://www.wiz.io/vulnerability-database/cve/cve-2024-42009
    - https://www.cisa.gov/news-events/alerts/2025/06/09/cisa-adds-two-known-exploited-vulnerabilities-catalog
    - https://cert.pl/en/posts/2025/06/unc1151-campaign-roundcube/
  metadata:
    vendor: Roundcube
    product: Roundcube Webmail
    cvss-score: 9.3
    cwe-id: CWE-79
    cisa-kev: true
    verified: true
  tags: cve,cve2024,kev,roundcube,xss

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    extractors:
      - type: regex
        name: major
        group: 1
        regex:
          - '"rcversion":(\d)'
        internal: true

      - type: regex
        name: minor
        group: 1
        regex:
          - '"rcversion":\d\d(\d)'
        internal: true

      - type: regex
        name: patch
        group: 1
        regex:
          - '"rcversion":\d\d\d(\d+)'
        internal: true

      - type: dsl
        name: version
        dsl:
          - major + "." + minor + "." + patch
        internal: true

      - type: dsl
        dsl:
          - '"Roundcube Version: "+ version'

    matchers-condition: and
    matchers:
      - type: dsl
        name: vulnerable
        dsl:
          - compare_versions(version, '<= 1.5.7') || (compare_versions(version,'>= 1.6.0') && compare_versions(version, '<= 1.6.7'))

      - type: word
        part: body
        words:
          - "Roundcube"

      - type: status
        status:
          - 200
