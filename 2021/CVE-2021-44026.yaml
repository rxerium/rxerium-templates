id: CVE-2021-44026

info:
  name: CVE-2021-44026 - Roundcube Webmail SQL Injection
  author: rxerium
  severity: critical
  description: |
    Roundcube Webmail versions before 1.3.17 and 1.4.x before 1.4.12 are prone to a potential SQL injection vulnerability via search or search_params parameters. This vulnerability allows attackers to execute arbitrary SQL commands and potentially gain unauthorized access to the underlying database. The vulnerability was added to CISA's Known Exploited Vulnerabilities catalog due to active exploitation by Russian state-sponsored APT28 hacking group in phishing campaigns with Ukrainian war news that contained exploits for this vulnerability.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2021-44026
    - https://www.cisa.gov/known-exploited-vulnerabilities-catalog
    - https://socprime.com/blog/cve-2020-35730-cve-2021-44026-cve-2020-12641-exploit-detection-apt28-group-abuses-roundcube-flaws-in-spearphishing-espionage-attacks/
    - https://csirt.csi.cip.gov.ua/en/posts/apt28-group
    - https://ubuntu.com/security/notices/USN-5182-1
  metadata:
    vendor: Roundcube
    product: Roundcube Webmail
    cvss-score: 9.8
    cwe-id: CWE-89
    cisa-kev: true
    verified: true
  tags: cve,cve2021,kev,roundcube,sqli

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    extractors:
      - type: regex
        name: major
        group: 1
        regex:
          - '"rcversion":(\d)'
        internal: true

      - type: regex
        name: minor
        group: 1
        regex:
          - '"rcversion":\d\d(\d)'
        internal: true

      - type: regex
        name: patch
        group: 1
        regex:
          - '"rcversion":\d\d\d(\d+)'
        internal: true

      - type: dsl
        name: version
        dsl:
          - major + "." + minor + "." + patch
        internal: true

      - type: dsl
        dsl:
          - '"Roundcube Version: "+ version'

    matchers-condition: and
    matchers:
      - type: dsl
        name: vulnerable
        dsl:
          - compare_versions(version, '< 1.3.17') || (compare_versions(version,'>= 1.4.0') && compare_versions(version, '< 1.4.12'))

      - type: word
        part: body
        words:
          - "Roundcube"

      - type: status
        status:
          - 200
