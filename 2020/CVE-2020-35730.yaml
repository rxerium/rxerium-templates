id: CVE-2020-35730

info:
  name: CVE-2020-35730 - Roundcube Webmail Cross-Site Scripting
  author: rxerium
  severity: medium
  description: |
    Roundcube Webmail versions before 1.2.13, 1.3.x before 1.3.16, and 1.4.x before 1.4.10 contain an XSS vulnerability where an attacker can send a plain text e-mail message with JavaScript in a link reference element that is mishandled by linkref_addindex in rcube_string_replacer.php. This vulnerability was actively exploited by Russian state-sponsored APT28 hacking group in phishing emails with Ukrainian war news that contained exploits for Roundcube vulnerabilities. The exploitation allows attackers to execute arbitrary JavaScript in victim's browser sessions.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2020-35730
    - https://socprime.com/blog/cve-2020-35730-cve-2021-44026-cve-2020-12641-exploit-detection-apt28-group-abuses-roundcube-flaws-in-spearphishing-espionage-attacks/
    - https://csirt.csi.cip.gov.ua/en/posts/apt28-group
    - https://dev.to/freedom_coder/cve-2020-35730-roundcube-webmail-cross-site-scripting-xss-vulnerability-2c10
    - https://ubuntu.com/security/notices/USN-5182-1
  metadata:
    vendor: Roundcube
    product: Roundcube Webmail
    cvss-score: 6.1
    cwe-id: CWE-79
    cisa-kev: false
    verified: true
  tags: cve,cve2020,roundcube,xss

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    extractors:
      - type: regex
        name: major
        group: 1
        regex:
          - '"rcversion":(\d)'
        internal: true

      - type: regex
        name: minor
        group: 1
        regex:
          - '"rcversion":\d\d(\d)'
        internal: true

      - type: regex
        name: patch
        group: 1
        regex:
          - '"rcversion":\d\d\d(\d+)'
        internal: true

      - type: dsl
        name: version
        dsl:
          - major + "." + minor + "." + patch
        internal: true

      - type: dsl
        dsl:
          - '"Roundcube Version: "+ version'

    matchers-condition: and
    matchers:
      - type: dsl
        name: vulnerable
        dsl:
          - compare_versions(version, '< 1.2.13') || (compare_versions(version,'>= 1.3.0') && compare_versions(version, '< 1.3.16')) || (compare_versions(version,'>= 1.4.0') && compare_versions(version, '< 1.4.10'))

      - type: word
        part: body
        words:
          - "Roundcube"

      - type: status
        status:
          - 200
