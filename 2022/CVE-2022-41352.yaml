id: CVE-2022-41352

info:
  name: CVE-2022-41352 - Zimbra Collaboration Suite Remote Code Execution
  author: rxerium
  severity: critical
  description: Zimbra Collaboration Suite (ZCS) 8.8.15 and 9.0 are affected by a remote code execution vulnerability that allows an unauthenticated attacker to upload arbitrary files through amavis via a cpio loophole. The vulnerability results from unsafe use of the cpio utility by Zimbra's antivirus engine (Amavis), enabling extraction to /opt/zimbra/jetty/webapps/zimbra/public and unauthorized access to user accounts. Exploitation requires emailing a .cpio, .tar, or .rpm file to an affected server.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2022-41352
    - https://wiki.zimbra.com/wiki/Zimbra_Security_Advisories
    - https://www.cisa.gov/known-exploited-vulnerabilities-catalog
    - https://www.rapid7.com/blog/post/2022/10/06/exploitation-of-unpatched-zero-day-remote-code-execution-vulnerability-in-zimbra-collaboration-suite-cve-2022-41352/
    - https://github.com/Cr4ckC4t/cve-2022-41352-zimbra-rce
  metadata:
    max-request: 1
    vendor: Synacor
    product: Zimbra Collaboration Suite
    cvss-score: 9.8
    cisa-kev: true
    verified: true
  tags: cve,cve2022,zimbra,rce,fileupload,kev

http:
  - method: GET
    path:
      - "{{BaseURL}}/js/zimbraMail/share/model/ZmSettings.js"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "Zimbra Collaboration Suite Web Client"

      - type: word
        part: header
        words:
          - "application/x-javascript"

      - type: word
        words:
          - "8.8.15"
          - "9.0"
        part: version

    extractors:
      - type: regex
        part: body
        group: 1
        regex:
          - 'CLIENT_VERSION\",					{type:ZmSetting.T_CONFIG, defaultValue:\"(.*?)"'